<!DOCTYPE html><html><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="HandheldFriendly" content="True"><meta name="description" content="å—¯ï¼Œé˜¿é‡Œ OSS æœ€è¿‘å‡ºäº†ä¸ªä¼˜æƒ ï¼Œ1Tå­˜å‚¨3å¹´99å…ƒï¼Œçœ‹èµ·æ¥è›®ä¾¿å®œçš„ï¼Œå½“ç„¶æµé‡è´¹å¦ç®—ï¼Œä¸è¿‡åŒåŒºåŸŸçš„å†…ç½‘æµé‡å…è´¹ï¼Œå…¥ç½‘æµé‡å…è´¹ï¼Œç°å¸¸é€‚åˆä½œå¤‡ä»½ã€‚å“ˆå“ˆ ğŸ˜„äºæ˜¯å¼„ä¸ªnextcloudï¼Œå€’è…¾ä¸€ä¸‹~~ï¼Œé¡ºé“è®°å½•ä¸€ä¸‹å€’è…¾è¿‡ç¨‹ã€‚"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="generator" content="Hexo"><meta name="description" content="å—¯ï¼Œé˜¿é‡Œ OSS æœ€è¿‘å‡ºäº†ä¸ªä¼˜æƒ ï¼Œ1Tå­˜å‚¨3å¹´99å…ƒï¼Œçœ‹èµ·æ¥è›®ä¾¿å®œçš„ï¼Œå½“ç„¶æµé‡è´¹å¦ç®—ï¼Œä¸è¿‡åŒåŒºåŸŸçš„å†…ç½‘æµé‡å…è´¹ï¼Œå…¥ç½‘æµé‡å…è´¹ï¼Œç°å¸¸é€‚åˆä½œå¤‡ä»½ã€‚å“ˆå“ˆ ğŸ˜„äºæ˜¯å¼„ä¸ªnextcloudï¼Œå€’è…¾ä¸€ä¸‹~~ï¼Œé¡ºé“è®°å½•ä¸€ä¸‹å€’è…¾è¿‡ç¨‹ã€‚"><meta property="og:type" content="website"><meta property="og:title" content="docker å®‰è£… Nextcloud ï¼Œå¹¶æŒ‚è½½é˜¿é‡Œäº‘ OSS | Lidong's blog"><meta property="og:url" content="https://lidong.me/blog/nextcloud/"><meta property="og:site_name" content="Lidong's blog"><meta property="og:description" content="å—¯ï¼Œé˜¿é‡Œ OSS æœ€è¿‘å‡ºäº†ä¸ªä¼˜æƒ ï¼Œ1Tå­˜å‚¨3å¹´99å…ƒï¼Œçœ‹èµ·æ¥è›®ä¾¿å®œçš„ï¼Œå½“ç„¶æµé‡è´¹å¦ç®—ï¼Œä¸è¿‡åŒåŒºåŸŸçš„å†…ç½‘æµé‡å…è´¹ï¼Œå…¥ç½‘æµé‡å…è´¹ï¼Œç°å¸¸é€‚åˆä½œå¤‡ä»½ã€‚å“ˆå“ˆ ğŸ˜„äºæ˜¯å¼„ä¸ªnextcloudï¼Œå€’è…¾ä¸€ä¸‹~~ï¼Œé¡ºé“è®°å½•ä¸€ä¸‹å€’è…¾è¿‡ç¨‹ã€‚"><meta property="og:locale" content="zh-CN"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="docker å®‰è£… Nextcloud ï¼Œå¹¶æŒ‚è½½é˜¿é‡Œäº‘ OSS | Lidong's blog"><meta name="twitter:description" content="å—¯ï¼Œé˜¿é‡Œ OSS æœ€è¿‘å‡ºäº†ä¸ªä¼˜æƒ ï¼Œ1Tå­˜å‚¨3å¹´99å…ƒï¼Œçœ‹èµ·æ¥è›®ä¾¿å®œçš„ï¼Œå½“ç„¶æµé‡è´¹å¦ç®—ï¼Œä¸è¿‡åŒåŒºåŸŸçš„å†…ç½‘æµé‡å…è´¹ï¼Œå…¥ç½‘æµé‡å…è´¹ï¼Œç°å¸¸é€‚åˆä½œå¤‡ä»½ã€‚å“ˆå“ˆ ğŸ˜„äºæ˜¯å¼„ä¸ªnextcloudï¼Œå€’è…¾ä¸€ä¸‹~~ï¼Œé¡ºé“è®°å½•ä¸€ä¸‹å€’è…¾è¿‡ç¨‹ã€‚"><meta name="twitter:creator" content="@Dondongooo"><link rel="alternate" href="./atom.xml" title="docker å®‰è£… Nextcloud ï¼Œå¹¶æŒ‚è½½é˜¿é‡Œäº‘ OSS | Lidong's blog"><link rel="canonical" href="https://lidong.me/blog/nextcloud/"><link rel="shortcut icon" href="/favicon.ico"><link rel="icon" sizes="192x192" href="/blog/icons/192.png"><link rel="apple-touch-icon" sizes="144x144" href="/blog/icons/144.png"><link rel="stylesheet" href="/blog/css/style.css"><link rel="manifest" href="/blog/manifest.json"><meta name="theme-color" content="#000000"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><title>docker å®‰è£… Nextcloud ï¼Œå¹¶æŒ‚è½½é˜¿é‡Œäº‘ OSS | Lidong's blog</title><script>if ("serviceWorker" in navigator) {
  navigator.serviceWorker
    .register("/blog/sw.js")
    .then(reg => console.log("service worker registered"))
    .catch(err => console.log("service worker not registered"));
}</script></head><body><div class="titlewrapper"><div class="container"><h1><a href="https://lidong.me/blog/">Lidong's blog</a></h1><nav class="clearfix"><ul><li><a href="https://lidong.me">HOME</a></li><li><a href="/blog/">BLOG</a></li></ul></nav></div></div><div class="wrap container"><div class="main"><article itemscope itemtype="http://schema.org/Article" id="post-nextcloud" class="post"><h1 itemprop="name" class="title">docker å®‰è£… Nextcloud ï¼Œå¹¶æŒ‚è½½é˜¿é‡Œäº‘ OSS</h1><div class="toc-container clearfix"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#é•œåƒé€‰æ‹©"><span class="toc-text">é•œåƒé€‰æ‹©</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å®‰è£…ä½¿ç”¨"><span class="toc-text">å®‰è£…ä½¿ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OSS-æŒ‚è½½æƒé™"><span class="toc-text">OSS æŒ‚è½½æƒé™</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å®¢æˆ·ç«¯åŒæ­¥è®¾ç½®"><span class="toc-text">å®¢æˆ·ç«¯åŒæ­¥è®¾ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#è®¾ç½®å¿½ç•¥æ–‡ä»¶"><span class="toc-text">è®¾ç½®å¿½ç•¥æ–‡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#è®¾ç½®éšè—æ–‡ä»¶åŒæ­¥"><span class="toc-text">è®¾ç½®éšè—æ–‡ä»¶åŒæ­¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å…¶å®ƒ"><span class="toc-text">å…¶å®ƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ›´æ–°è®°å½•"><span class="toc-text">æ›´æ–°è®°å½•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å‚è€ƒé“¾æ¥"><span class="toc-text">å‚è€ƒé“¾æ¥</span></a></li></ol></div><div itemprop="articleBody" class="article-content"><p>å—¯ï¼Œé˜¿é‡Œ OSS æœ€è¿‘å‡ºäº†ä¸ªä¼˜æƒ ï¼Œ1Tå­˜å‚¨3å¹´99å…ƒï¼Œçœ‹èµ·æ¥è›®ä¾¿å®œçš„ï¼Œå½“ç„¶æµé‡è´¹å¦ç®—ï¼Œä¸è¿‡åŒåŒºåŸŸçš„å†…ç½‘æµé‡å…è´¹ï¼Œå…¥ç½‘æµé‡å…è´¹ï¼Œç°å¸¸é€‚åˆä½œå¤‡ä»½ã€‚å“ˆå“ˆ ğŸ˜„<br>äºæ˜¯å¼„ä¸ªnextcloudï¼Œå€’è…¾ä¸€ä¸‹~~ï¼Œé¡ºé“è®°å½•ä¸€ä¸‹å€’è…¾è¿‡ç¨‹ã€‚</p>
<a id="more"></a>
<h2 id="é•œåƒé€‰æ‹©"><a href="#é•œåƒé€‰æ‹©" class="headerlink" title="é•œåƒé€‰æ‹©"></a>é•œåƒé€‰æ‹©</h2><p><img src="https://static.lidong.me/upload/images/SJS6BxLrQ.png" alt="nextcloud-docker-tags.png"></p>
<p><a href="https://hub.docker.com/_/nextcloud/" target="_blank" rel="noopener">æŸ¥çœ‹é“¾æ¥</a></p>
<p>å®˜æ–¹æä¾›äº†å¤šç§ç‰ˆæœ¬çš„ image ï¼Œç›®å‰æœ€æ–°ç¨³å®šç‰ˆæ˜¯ <code>13.x.x</code> æˆ‘é€‰æ‹©çš„æ˜¯ <code>nextcloud:stable-apache</code>ï¼Œè¿™æ˜¯æˆ‘çš„ <code>docker-compose.yml</code>æ–‡ä»¶</p>
<figure class="highlight yml"><figcaption><span>docker-compose.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">"2.0"</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">mysql:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:5.7</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/var/datadir:/var/lib/mysql</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">     <span class="attr">MYSQL_ROOT_PASSWORD:</span> <span class="string">mysql_root_password</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">nextcloud:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nextcloud:stable-apache</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">expose:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">"80"</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/nextcloud/html:/var/www/html</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">website:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">onnno/nginx:latest</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">443</span><span class="string">:443</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">80</span><span class="string">:80</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/var/www:/var/www</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/etc/nginx/conf.d:/usr/local/nginx/conf.d</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/var/log/nginx:/usr/local/nginx/logs</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/etc/letsencrypt:/etc/letsencrypt</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">nextcloud</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™é‡Œç®€åŒ–è¿‡çš„ <code>docker-compose.yml</code> ã€‚å› ä¸ºMySQLçš„å¯†ç ç›´æ¥å†™åœ¨äº† yml æ–‡ä»¶ä¸­ï¼Œå°±ä¸è´´å®Œæ•´åŸæ–‡ä»¶äº†ï¼Œä»…ä¾›å‚è€ƒï¼Œä½¿ç”¨æ—¶æ³¨æ„æ›¿æ¢ã€‚</p>
</blockquote>
<h2 id="å®‰è£…ä½¿ç”¨"><a href="#å®‰è£…ä½¿ç”¨" class="headerlink" title="å®‰è£…ä½¿ç”¨"></a>å®‰è£…ä½¿ç”¨</h2><p>é€šè¿‡ä½ çš„åŸŸåæˆ–IPè®¿é—®ä½ çš„æœåŠ¡å™¨å®‰è£…å°±å¯ä»¥äº†ï¼Œæ“ä½œç®€å•ï¼Œå°±ä¸ç»†è¯´äº†ï¼Œå¦‚æœ‰éœ€è¦ï¼ŒæŸ¥çœ‹æˆ‘çš„ <a href="https://github.com/ryanlid/nginx-conf" target="_blank" rel="noopener">Nginxçš„é…ç½®</a> ä»¥åŠæˆ‘çš„ <a href="https://github.com/ryanlid/nginx-conf/blob/master/cloud.lidong.me.conf" target="_blank" rel="noopener"> Nextcloud Nginxçš„é…ç½®</a></p>
<blockquote>
<p>æ³¨æ„ï¼šå®‰è£…å¡«å†™ MySQL æ•°æ®åœ°å€è¦å¡«å†™ <code>mysql</code>, è€Œä¸æ˜¯ <code>localhost</code> äº†</p>
</blockquote>
<h2 id="OSS-æŒ‚è½½æƒé™"><a href="#OSS-æŒ‚è½½æƒé™" class="headerlink" title="OSS æŒ‚è½½æƒé™"></a>OSS æŒ‚è½½æƒé™</h2><p>é˜¿é‡Œ OSS æä¾›ä¸€ä¸ªå·¥å…· ossfs ï¼Œ å¯ä»¥å°† OSS æŒ‚è½½åˆ°æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸Šã€‚</p>
<p>æŸ¥çœ‹<a href="https://help.aliyun.com/document_detail/32196.html" target="_blank" rel="noopener">ossæ–‡æ¡£</a></p>
<p>å…ˆæŒ‰ç…§æ–‡æ¡£å®‰è£…ossfsï¼Œé…ç½® passwd-ossfs ï¼ŒæŒ‚è½½ç›®å½•å°±ä¸èƒ½æŒ‰ç…§æ–‡æ¡£æ“ä½œäº†ï¼Œå› ä¸º NextCloud æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œâ€œå¤–éƒ¨å­˜å‚¨â€ æŒ‚è½½çš„ç›®å½•æƒé™å¿…é¡»æ˜¯ 0770 ï¼Œç”¨æˆ·æ˜¯ 33ï¼Œï¼ˆä¹Ÿä¸çŸ¥é“æ˜¯ä¸ºä»€ä¹ˆæ˜¯è¿™ä¸ªé¬¼ï¼Œåº”è¯¥ docker çš„é—®é¢˜ï¼‰ï¼Œå¦åˆ™åœ¨ä½¿ç”¨ NextCloud æ—¶æ— æ³•è¯»å–åˆ°æ–‡ä»¶ã€‚</p>
<p>æ­£ç¡®çš„æŒ‚è½½æ–¹å¼ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># my-bucket:ossçš„bucketå ouid: ç”¨æˆ·id ogid:ç»„id</span></span><br><span class="line">ossfs my-bucket my-mount-point -ourl=my-oss-endpoint -ouid=33 -ogid=0  -oumask=007 -o allow_other</span><br></pre></td></tr></table></figure>
<p>å…·ä½“ç¼˜ç”±ï¼š<a href="https://github.com/aliyun/ossfs/wiki/FAQ#11" target="_blank" rel="noopener">çœ‹è¿™é‡Œ</a> å’Œ <a href="https://github.com/aliyun/ossfs/issues/5" target="_blank" rel="noopener">çœ‹è¿™é‡Œ</a></p>
<p>è¿™æ˜¯æˆ‘çš„æŒ‚è½½å‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ossfs cloud-fs /var/nextcloud/html/cloudossfs -ourl=http://oss-cn-hongkong-internal.aliyuncs.com -ouid=33 -ogid=0  -oumask=007 -o allow_other</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„ï¼šå› ä¸ºæˆ‘åœ¨ docker æ˜ å°„çš„æ˜¯ <code>/var/nextcloud/html/</code> ç›®å½•ï¼Œ <code>my-mount-point</code> å¿…é¡»åœ¨ <code>/var/nextcloud/html/</code>ä¹‹ä¸‹ï¼Œå¦åˆ™åœ¨å®¹å™¨ä¸­æ˜¯è¯»å–ä¸åˆ°çš„ã€‚</p>
<p>æˆ‘è¿™é‡Œ my-mount-point æ˜¯ <code>/var/nextcloud/html/cloudossfs</code>ï¼Œåœ¨dockerå®¹å™¨ä¸­å¯¹åº”çš„åˆ™æ˜¯<code>/var/www/html/cloudossfs</code></p>
</blockquote>
<p>è¿™æ—¶åœ¨ Nextcloud ä¸­å¯ç”¨ External storage support åº”ç”¨ï¼ˆæ’ä»¶ï¼‰ï¼Œæ·»åŠ è·¯å¾„å°±å¯ä»¥é€šè¿‡ OSS å­˜å–æ•°æ®å•¦ã€‚</p>
<p><img src="https://static.lidong.me/upload/images/r1TzObIrX.png" alt="External storage"></p>
<blockquote>
<p>çœ‹ä¸æ¸…å›¾ç‰‡ï¼Œå¯ä»¥å³é”®å›¾ç‰‡ï¼Œé€‰æ‹©æ–°æ ‡ç­¾é¡µæ‰“å¼€å›¾ç‰‡</p>
</blockquote>
<p>å¦‚æœè¿˜æ˜¯ä¸è¡Œï¼Œå°è¯•è¿›å…¥åˆ°å®¹å™¨ï¼Œå°† <code>/var/www/html/cloudossfs</code> ç›®å½•çš„ç”¨æˆ·å±æ€§æ‰‹åŠ¨ä¿®æ”¹ä¸º <code>www-data</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown www-data:root /var/www/html/cloudossfs/</span><br></pre></td></tr></table></figure>
<p>é‡æ–°æ‰«æç”¨æˆ·æ–‡ä»¶</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u www-data php occ files:scan --all</span><br></pre></td></tr></table></figure>
<p>ç¼˜ç”±<a href="https://www.zhihu.com/question/267841887/answer/393946741" target="_blank" rel="noopener">çœ‹è¿™é‡Œ</a></p>
<p>åœ¨å®¹å™¨ä¸­ä¸å¸¦ <code>sudo</code> å‘½ä»¤ï¼Œéœ€è¦å®‰è£…</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt update &amp;&amp; apt install sudo</span><br></pre></td></tr></table></figure>
<blockquote>
<p>PSï¼š æœ€åˆæˆ‘ä¹Ÿæ˜¯æƒ³æŠŠ Nextcloud ä¸­çš„æ•´ä¸ªç›®å½•éƒ½æ˜ å°„åˆ° OSS çš„ä¸­çš„ï¼Œå³ä¸Šé¢çš„ç›®å½• <code>/var/nextcloud/html:/var/www/html</code>ï¼Œå› ä¸ºæƒé™é—®é¢˜ Nextcloud ä¸€ç›´æ²¡æœ‰æ“ä½œæˆåŠŸï¼Œè€Œä¸”æ–‡ä»¶å·¨å¤šï¼Œä¸ç®—ç”¨æˆ·ä¸Šä¼ çš„æ•°æ®ï¼Œå°±æœ‰13000å¤šä¸ªï¼Œ OSS çš„ä¸€éƒ¨åˆ†è´¹ç”¨æ˜¯æŒ‰è¯·æ±‚è®¡ç®—çš„ï¼Œæ¯1ä¸‡æ¬¡1åˆ†é’±ã€‚åœ¨å®‰è£…è¿‡ç¨‹ä¸­ï¼Œæ‹·è´äº†ä¸¤æ¬¡ï¼Œäº§ç”Ÿäº†ä¸¤ä¸‡å¤šä¸ªè¯·æ±‚ã€‚ç›´æ¥æŠŠæˆ‘ OSS è´¦å·ææ¬ è´¹äº†ï¼ˆå› ä¸ºè´¦å·æœ¬æ²¡æœ‰ä½™é¢ğŸ˜†ï¼‰ï¼Œäºæ˜¯æ”¾å¼ƒäº†ã€‚</p>
</blockquote>
<h2 id="å®¢æˆ·ç«¯åŒæ­¥è®¾ç½®"><a href="#å®¢æˆ·ç«¯åŒæ­¥è®¾ç½®" class="headerlink" title="å®¢æˆ·ç«¯åŒæ­¥è®¾ç½®"></a>å®¢æˆ·ç«¯åŒæ­¥è®¾ç½®</h2><p>Nextcouldæ˜¯è§è¿‡ä¸ºæ•°ä¸å¤šçš„æ”¯æŒè‡ªå®šä¹‰å¿½ç•¥æ–‡ä»¶ã€æ–‡ä»¶å¤¹çš„äº‘åŒæ­¥è½¯ä»¶</p>
<h3 id="è®¾ç½®å¿½ç•¥æ–‡ä»¶"><a href="#è®¾ç½®å¿½ç•¥æ–‡ä»¶" class="headerlink" title="è®¾ç½®å¿½ç•¥æ–‡ä»¶"></a>è®¾ç½®å¿½ç•¥æ–‡ä»¶</h3><p>åœ¨Windowsä¸Šï¼Œå¿½ç•¥æ–‡ä»¶çš„é…ç½®æ–‡ä»¶ä¿å­˜åœ¨<code>C:\Program Files (x86)\Nextcloud\sync-exclude.lst</code>ä¸­ã€‚</p>
<p>å…¶ä»–æ“ä½œç³»ç»Ÿï¼Œè¯·è‡ªè¡ŒæŸ¥æ‰¾ï¼Œå¯ä»¥åœ¨å®¢æˆ·ç«¯çš„è®¾ç½®ä¸­æŸ¥çœ‹</p>
<p>æ‰¾åˆ°æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ«å°¾ï¼Œæ·»åŠ  <code>node_modules</code> ï¼ŒåŒæ­¥çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨è·³è¿‡ <code>node_modules</code> ç›®å½•äº† ğŸ˜†</p>
<h3 id="è®¾ç½®éšè—æ–‡ä»¶åŒæ­¥"><a href="#è®¾ç½®éšè—æ–‡ä»¶åŒæ­¥" class="headerlink" title="è®¾ç½®éšè—æ–‡ä»¶åŒæ­¥"></a>è®¾ç½®éšè—æ–‡ä»¶åŒæ­¥</h3><p>Nextcloud é»˜è®¤æ˜¯ä¸åŒæ­¥éšè—æ–‡ä»¶çš„ï¼Œå³ç‚¹å¼€å¤´çš„æ–‡ä»¶</p>
<p>æ–‡æ¡£åœ¨è¿™é‡Œï¼š<a href="https://docs.nextcloud.com/desktop/2.3/advancedusage.html#configuration-file" target="_blank" rel="noopener">é“¾æ¥</a></p>
<ul>
<li><p>Linux</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">HOME/.config/Nextcloud/nextcloud.cfg</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Windows</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">%</span><span class="bash">APPDATA%\Nextcloud\nextcloud.cfg</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>macOS</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">HOME/Library/Preferences/Nextcloud/nextcloud.cfg</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>å°† <code>ignoreHiddenFiles=true</code> ä¿®æ”¹ä¸º <code>ignoreHiddenFiles=false</code> å³å¯</p>
<blockquote>
<p>æŒ‰æ–‡æ¡£æ¥è¯´æ˜¯è¿™æ ·ï¼Œä½†æ˜¯ä¿®æ”¹åé‡å¯å®¢æˆ·ç«¯åï¼Œå°±æ— æ³•è¿æ¥æœåŠ¡ç«¯äº†ã€‚è²Œä¼¼æ˜¯ bug äº†ï¼Œé¢ï¼Œå°´å°¬ã€‚ğŸ˜±</p>
</blockquote>
<h2 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="headerlink" title="å…¶å®ƒ"></a>å…¶å®ƒ</h2><ol>
<li><p>é€šå¸¸ï¼Œåœ¨è®¿é—® Nextcloud è¿‡ç¨‹ä¸­ï¼Œç¨‹åºä¼šè‡ªåŠ¨æ£€æŸ¥è¯·æ±‚æ˜¯ http è¯·æ±‚è¿˜æ˜¯ https è¯·æ±‚ï¼Œè€ŒåŠ¨æ€ç”Ÿæˆé¡µé¢ä¸­èµ„æºçš„é“¾æ¥ï¼Œè€Œç°åœ¨çš„éƒ¨ç½²æ–¹å¼ï¼Œä½¿ç”¨nginxä»£ç†è¿‡è¯·æ±‚ï¼Œ å¦‚æœæ˜¯æ˜¯httpsè®¿é—®ï¼Œç¨‹åºå¹¶ä¸èƒ½æ£€æµ‹åˆ°httpsè¯·æ±‚ï¼Œæ‰€ä»¥éœ€è¦åœ¨ Nextcloud é…ç½®æ–‡ä»¶ <code>/var/nextcloud/html/config/config.php</code> æ·»åŠ ä¸º <code>&#39;overwriteprotocol&#39; =&gt; &#39;https&#39;</code>æ¥è¦†ç›–é»˜è®¤è®¾ç½®ã€‚</p>
</li>
<li><p>å¦‚æœè¦ä¸Šä¼ å¤§æ–‡ä»¶ï¼Œæ³¨æ„åœ¨nginxä¸­è®¾ç½® <code>client_max_body_size</code> ,çœ‹æˆ‘çš„<a href="https://github.com/ryanlid/nginx-conf/blob/5678e4bab3b7a34ec92043e3a9566fc471d04775/cloud.lidong.me.conf#L14" target="_blank" rel="noopener">ç¤ºä¾‹</a></p>
</li>
<li><p>æ¬¢è¿ä½¿ç”¨æˆ‘çš„é˜¿é‡Œäº‘çš„ <a href="https://promotion.aliyun.com/ntms/act/oss-discount.html?userCode=hk4wst53" target="_blank" rel="noopener">æ¨èé“¾æ¥</a> ï¼Œå‚å›¢ä¸€èµ·è´­ä¹°æœ‰ä¼˜æƒ ï¼Œä½ æ‡‚çš„ ~~~</p>
</li>
</ol>
<h2 id="æ›´æ–°è®°å½•"><a href="#æ›´æ–°è®°å½•" class="headerlink" title="æ›´æ–°è®°å½•"></a>æ›´æ–°è®°å½•</h2><ol>
<li>2018/8/6 20:21:27 é¦–æ¬¡å‘å¸ƒ</li>
</ol>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ol>
<li><a href="http://crabdave.iteye.com/blog/2356624" target="_blank" rel="noopener">ä½¿ç”¨OwnCloud Dockerå®¹å™¨+é˜¿é‡Œäº‘OSSæ­å»ºè‡ªå·±çš„äº‘ç›˜æœåŠ¡ on Centos 7</a></li>
<li><a href="https://oing9179.github.io/blog/2017/03/Setup-Nextcloud-using-Docker-and-Nginx/" target="_blank" rel="noopener">ç”¨ Docker å’Œ Nginx æ­å»ºè‡ªå·±çš„äº‘æœåŠ¡å™¨ï¼ˆNextcloudï¼‰</a></li>
</ol>
<div class="post-info">å‘è¡¨äº<time itemprop="datePublished" content="2018-08-06T20:21:27.000Z">2018/8/6 20:21:27</time>ï¼Œå¹¶è¢«æ·»åŠ ã€Œ <a class="tag-link" href="/blog/tags/docker/">docker</a>, <a class="tag-link" href="/blog/tags/nextcloud/">nextcloud</a>, <a class="tag-link" href="/blog/tags/oss/">oss</a>, <a class="tag-link" href="/blog/tags/owncloud/">owncloud</a> ã€æ ‡ç­¾ï¼Œæœ€åä¿®æ”¹äº<time itemprop="dateModified" content="2018-08-06T20:21:27.000Z">2018/8/6 20:21:27</time></div><p>æœ¬æ–‡é“¾æ¥ï¼š<a href="https://lidong.me/blog/nextcloud/" title="docker å®‰è£… Nextcloud ï¼Œå¹¶æŒ‚è½½é˜¿é‡Œäº‘ OSS" itemprop="url">https://lidong.me/blog/nextcloud/</a></p></div></article><hr><div id="comment"><div id="disqus_thread"><div>è¯„è®ºå†…å®¹è¿˜åœ¨åŠ è½½ä¸­ã€‚ã€‚ã€‚</div><div>å¦‚æ— æ³•åŠ è½½ï¼Œè¯·å°†åŸŸå disqus.com å’Œ disquscdn.com åŠ å…¥åˆ°ä½ çš„ä»£ç†è§„åˆ™ä¸­</div></div></div><script>var flag = true;
window.onscroll = function() {
  //- é¡µé¢å‘ä¸‹æ»šåŠ¨è·ç¦»
  var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
  //- æ˜¾ç¤ºåŒºåŸŸé«˜åº¦
  var clientHeight = document.documentElement.clientHeight;
  //- è¯„è®ºåŒºè·ç¦»é¡µé¢é¡¶éƒ¨é«˜åº¦
  var commentOffset = document.getElementById('comment').offsetTop;
  if(scrollTop + clientHeight>commentOffset && flag){
    flag = false;
    var disqus_config = function () {
      console.log(this.page.url)
      console.log(this.page.identifier)
      this.page.url = "https://lidong.me/blog/nextcloud/"; // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "docker å®‰è£… Nextcloud ï¼Œå¹¶æŒ‚è½½é˜¿é‡Œäº‘ OSS";               // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function () {
      var d = document,
        s = d.createElement('script');
      s.src = "https://lidongme.disqus.com/embed.js";
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}</script></div><nav class="page-navigator"></nav><aside class="sidebar"><div><hr><div class="tagcloud"><a href="/blog/tags/adb/" style="font-size: 14px;">adb</a> <a href="/blog/tags/android/" style="font-size: 15.71px;">android</a> <a href="/blog/tags/api/" style="font-size: 14.86px;">api</a> <a href="/blog/tags/app/" style="font-size: 14px;">app</a> <a href="/blog/tags/atom/" style="font-size: 14px;">atom</a> <a href="/blog/tags/bash/" style="font-size: 14px;">bash</a> <a href="/blog/tags/bitcoin/" style="font-size: 14px;">bitcoin</a> <a href="/blog/tags/centos/" style="font-size: 15.71px;">centos</a> <a href="/blog/tags/chrome/" style="font-size: 14px;">chrome</a> <a href="/blog/tags/ci/" style="font-size: 14px;">ci</a> <a href="/blog/tags/codepen/" style="font-size: 14.86px;">codepen</a> <a href="/blog/tags/cordova/" style="font-size: 14px;">cordova</a> <a href="/blog/tags/cors/" style="font-size: 14px;">cors</a> <a href="/blog/tags/css/" style="font-size: 15.71px;">css</a> <a href="/blog/tags/css3/" style="font-size: 14px;">css3</a> <a href="/blog/tags/curl/" style="font-size: 14px;">curl</a> <a href="/blog/tags/dlna/" style="font-size: 14px;">dlna</a> <a href="/blog/tags/dns/" style="font-size: 14px;">dns</a> <a href="/blog/tags/dnsmasq/" style="font-size: 14px;">dnsmasq</a> <a href="/blog/tags/docker/" style="font-size: 20px;">docker</a> <a href="/blog/tags/docker-compose/" style="font-size: 14.86px;">docker-compose</a> <a href="/blog/tags/dropbox/" style="font-size: 14px;">dropbox</a> <a href="/blog/tags/ecmascript-6/" style="font-size: 14px;">ecmascript 6</a> <a href="/blog/tags/es6/" style="font-size: 14px;">es6</a> <a href="/blog/tags/ffmpeg/" style="font-size: 14.86px;">ffmpeg</a> <a href="/blog/tags/file/" style="font-size: 14px;">file</a> <a href="/blog/tags/firebase/" style="font-size: 14px;">firebase</a> <a href="/blog/tags/firefox/" style="font-size: 14px;">firefox</a> <a href="/blog/tags/flutter/" style="font-size: 14.86px;">flutter</a> <a href="/blog/tags/formdata/" style="font-size: 14px;">formdata</a> <a href="/blog/tags/frp/" style="font-size: 14px;">frp</a> <a href="/blog/tags/git/" style="font-size: 16.57px;">git</a> <a href="/blog/tags/github/" style="font-size: 14px;">github</a> <a href="/blog/tags/gitlab/" style="font-size: 14.86px;">gitlab</a> <a href="/blog/tags/gitlab-ci/" style="font-size: 14px;">gitlab-ci</a> <a href="/blog/tags/google-analytics/" style="font-size: 14px;">google analytics</a> <a href="/blog/tags/gulp/" style="font-size: 14.86px;">gulp</a> <a href="/blog/tags/hash/" style="font-size: 14px;">hash</a> <a href="/blog/tags/hexo/" style="font-size: 14.86px;">hexo</a> <a href="/blog/tags/homebrew/" style="font-size: 14px;">homebrew</a> <a href="/blog/tags/hosts/" style="font-size: 14px;">hosts</a> <a href="/blog/tags/html/" style="font-size: 14.86px;">html</a> <a href="/blog/tags/html5/" style="font-size: 15.71px;">html5</a> <a href="/blog/tags/http/" style="font-size: 16.57px;">http</a> <a href="/blog/tags/https/" style="font-size: 14px;">https</a> <a href="/blog/tags/ios/" style="font-size: 14px;">ios</a> <a href="/blog/tags/jade/" style="font-size: 14px;">jade</a> <a href="/blog/tags/javascript/" style="font-size: 16.57px;">javascript</a> <a href="/blog/tags/key/" style="font-size: 14px;">key</a> <a href="/blog/tags/l2tp/" style="font-size: 14px;">l2tp</a> <a href="/blog/tags/letsencrypt/" style="font-size: 14px;">letsencrypt</a> <a href="/blog/tags/linux/" style="font-size: 19.14px;">linux</a> <a href="/blog/tags/lnmp/" style="font-size: 14.86px;">lnmp</a> <a href="/blog/tags/loading/" style="font-size: 14px;">loading</a> <a href="/blog/tags/macos/" style="font-size: 16.57px;">macos</a> <a href="/blog/tags/mysql/" style="font-size: 15.71px;">mysql</a> <a href="/blog/tags/nextcloud/" style="font-size: 14px;">nextcloud</a> <a href="/blog/tags/nginx/" style="font-size: 18.29px;">nginx</a> <a href="/blog/tags/nodejs/" style="font-size: 16.57px;">nodejs</a> <a href="/blog/tags/notes/" style="font-size: 14px;">notes</a> <a href="/blog/tags/oss/" style="font-size: 14px;">oss</a> <a href="/blog/tags/owncloud/" style="font-size: 14px;">owncloud</a> <a href="/blog/tags/php/" style="font-size: 16.57px;">php</a> <a href="/blog/tags/plex/" style="font-size: 14px;">plex</a> <a href="/blog/tags/progressive-web-app/" style="font-size: 14px;">progressive web app</a> <a href="/blog/tags/proxy/" style="font-size: 14.86px;">proxy</a> <a href="/blog/tags/pug/" style="font-size: 14px;">pug</a> <a href="/blog/tags/pwa/" style="font-size: 14.86px;">pwa</a> <a href="/blog/tags/python/" style="font-size: 14px;">python</a> <a href="/blog/tags/qrcode/" style="font-size: 14px;">qrcode</a> <a href="/blog/tags/raspberrypi/" style="font-size: 18.29px;">raspberrypi</a> <a href="/blog/tags/safari/" style="font-size: 14px;">safari</a> <a href="/blog/tags/server/" style="font-size: 14px;">server</a> <a href="/blog/tags/service-worker/" style="font-size: 14px;">service worker</a> <a href="/blog/tags/shadowsocks/" style="font-size: 14px;">shadowsocks</a> <a href="/blog/tags/shell/" style="font-size: 14px;">shell</a> <a href="/blog/tags/squid/" style="font-size: 14px;">squid</a> <a href="/blog/tags/ssh/" style="font-size: 14.86px;">ssh</a> <a href="/blog/tags/swap/" style="font-size: 14px;">swap</a> <a href="/blog/tags/termux/" style="font-size: 14px;">termux</a> <a href="/blog/tags/tor/" style="font-size: 14px;">tor</a> <a href="/blog/tags/travis-ci/" style="font-size: 14px;">travis-ci</a> <a href="/blog/tags/tsè§†é¢‘æµ/" style="font-size: 14px;">tsè§†é¢‘æµ</a> <a href="/blog/tags/ubuntu/" style="font-size: 15.71px;">ubuntu</a> <a href="/blog/tags/vim/" style="font-size: 14px;">vim</a> <a href="/blog/tags/vnc/" style="font-size: 14px;">vnc</a> <a href="/blog/tags/vpn/" style="font-size: 14.86px;">vpn</a> <a href="/blog/tags/vscode/" style="font-size: 14px;">vscode</a> <a href="/blog/tags/vuejs/" style="font-size: 14px;">vuejs</a> <a href="/blog/tags/web/" style="font-size: 15.71px;">web</a> <a href="/blog/tags/web-api/" style="font-size: 14px;">web-api</a> <a href="/blog/tags/webpack/" style="font-size: 14.86px;">webpack</a> <a href="/blog/tags/webpack4/" style="font-size: 14px;">webpack4</a> <a href="/blog/tags/weex/" style="font-size: 14px;">weex</a> <a href="/blog/tags/windows/" style="font-size: 15.71px;">windows</a> <a href="/blog/tags/wordpress/" style="font-size: 14.86px;">wordpress</a> <a href="/blog/tags/wsl/" style="font-size: 14px;">wsl</a> <a href="/blog/tags/zsh/" style="font-size: 14px;">zsh</a> <a href="/blog/tags/ä¸»é¢˜/" style="font-size: 14px;">ä¸»é¢˜</a> <a href="/blog/tags/ä»£ç†/" style="font-size: 14.86px;">ä»£ç†</a> <a href="/blog/tags/å†…ç½‘ç©¿é€/" style="font-size: 14px;">å†…ç½‘ç©¿é€</a> <a href="/blog/tags/å‰ç«¯/" style="font-size: 17.43px;">å‰ç«¯</a> <a href="/blog/tags/å‘½ä»¤/" style="font-size: 14px;">å‘½ä»¤</a> <a href="/blog/tags/å›¾ç‰‡ä¸Šä¼ /" style="font-size: 14px;">å›¾ç‰‡ä¸Šä¼ </a> <a href="/blog/tags/å¤‡ä»½/" style="font-size: 14px;">å¤‡ä»½</a> <a href="/blog/tags/å°ä½œå“/" style="font-size: 15.71px;">å°ä½œå“</a> <a href="/blog/tags/æ¨¡ç‰ˆ/" style="font-size: 14px;">æ¨¡ç‰ˆ</a> <a href="/blog/tags/æ¯”ç‰¹å¸/" style="font-size: 14px;">æ¯”ç‰¹å¸</a> <a href="/blog/tags/æµè§ˆå™¨/" style="font-size: 14px;">æµè§ˆå™¨</a> <a href="/blog/tags/æ·±ç½‘/" style="font-size: 14px;">æ·±ç½‘</a> <a href="/blog/tags/ç¯å¢ƒ/" style="font-size: 14px;">ç¯å¢ƒ</a> <a href="/blog/tags/ç¼–è¾‘å™¨/" style="font-size: 14.86px;">ç¼–è¾‘å™¨</a> <a href="/blog/tags/è§†é¢‘ä¸‹è½½/" style="font-size: 14px;">è§†é¢‘ä¸‹è½½</a> <a href="/blog/tags/è¯»ä¹¦ç¬”è®°/" style="font-size: 14px;">è¯»ä¹¦ç¬”è®°</a> <a href="/blog/tags/è·¨åŸŸ/" style="font-size: 14px;">è·¨åŸŸ</a> <a href="/blog/tags/é•œåƒ/" style="font-size: 14px;">é•œåƒ</a></div></div><div class="clearfix"><hr><div class="archives"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2020/02/">äºŒæœˆ 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/08/">å…«æœˆ 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/07/">ä¸ƒæœˆ 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/06/">å…­æœˆ 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/05/">äº”æœˆ 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/04/">å››æœˆ 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/03/">ä¸‰æœˆ 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/12/">åäºŒæœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/11/">åä¸€æœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/10/">åæœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/08/">å…«æœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/07/">ä¸ƒæœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/06/">å…­æœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/05/">äº”æœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/04/">å››æœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/03/">ä¸‰æœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/02/">äºŒæœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/01/">ä¸€æœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2017/08/">å…«æœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2017/06/">å…­æœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2017/05/">äº”æœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2017/03/">ä¸‰æœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2017/02/">äºŒæœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2017/01/">ä¸€æœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/12/">åäºŒæœˆ 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/11/">åä¸€æœˆ 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/10/">åæœˆ 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/09/">ä¹æœˆ 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/08/">å…«æœˆ 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/07/">ä¸ƒæœˆ 2016</a></li></ul></div></div></aside></div><footer class="container"><div class="copyrigt"></div>Power by &nbsp;<a href="https://github.com/hexojs/hexo" rel="nofollow noopener">hexojs</a>&nbsp;|&nbsp;Theme by&nbsp;<a href="https://github.com/ryanlid/hexo-theme-simple" rel="nofollow noopener">simple</a>&nbsp;|&nbsp;Create by&nbsp;<a href="https://lidong.me">Lidong</a></footer></body></html>